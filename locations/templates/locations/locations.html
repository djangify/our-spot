{% extends "base.html" %}
{% load static %}

{% block title %}Locations{% endblock title %}
<!-- Code to list all the locations added by all users-->

{% block content %}

<div class="container my-5">
    <h1>Recent Spots</h1>
    <div class="row infinite-container">

        {% for location in locations %}
        <div class="infinite-item">
            <a href="{{ location.get_absolute_url }}"  aria-label="Click to view {{ location.title }}">
            <img src="{{ location.image.url }}" alt="{{ location.image_alt }}" style="max-width: 75%; height: auto;">
            </a>
            
            <h3>{{location.title}}</h3>
            <p>{{location.description|truncatechars:100}}</p>
                
        </div>
        </a>
    </div>
    {% endfor %}
</div>


<div class="d-flex d-none position-fixed" style="top:35vh;left:46vw">
    <button class="btn btn-primary loading">
        <span class="spinner-border spinner-border-sm"></span>
        Please wait...
    </button>
</div>
<div class="row">
    <div class="col-12">
        {% if page_obj.has_next %}
        <a class="infinite-more-link" href="?page={{ page_obj.next_page_number }}">next</a>
        {% endif %}
    </div>
</div>

<script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
<script src="{% static 'js/infinite.min.js' %}"></script>

<script>
    var infinite = new Waypoint.Infinite({
        element: $('.infinite-container')[0],

        offset: 'bottom-in-view',

        onBeforePageLoad: function () {
            $('.loading').show();
        },
        onAfterPageLoad: function () {
            $('.loading').hide();
        }

    });
</script>

{% endblock content %}