{% load static %}

<!-- Code to appear on all pages-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Show Your Spot - Photo Sharing Platform and Social Network for Sharing Your Favorite Places">
    <meta name="keywords" content="share your spot, show your spot, photo sharing, favorite locations, hidden gems, things to do, family holidays, wedding venue">
    
    <!-- Facebook App ID - Adding here ensures it's available across all pages -->
    <meta property="fb:app_id" content="976224278058250" />

    {% block meta %}{% endblock %}
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">
    <link rel="icon" type="image/png" sizes="192x192"
    href="{% static 'images/android-chrome-192x192.png' %}">
    <link rel="icon" type="image/png" sizes="512x512"
    href="{% static 'images/android-chrome-512x512.png' %}">
    <link rel="apple-touch-icon"
    sizes="180x180"
    href="{% static 'images/apple-touch-icon.png' %}">
    <link rel="icon"
    type="image/png"
    sizes="32x32"
    href="{% static 'images/favicon-32x32.png' %}">
    <link rel="icon"
    type="image/png"
    sizes="16x16"
    href="{% static 'images/favicon-16x16.png' %}">

    {% block extra_css %}
    <!-- Font Awesome link -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <!-- css style link -->
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <link href="{% static 'css/output.css' %}" rel="stylesheet">
    
    {% endblock %}

    <title>Show Your Spot - {% block title %} {% endblock %}</title>
</head>
<body class="site">
    
    <!-- Include the navigation bar -->
    {% include 'includes/navbar.html' %}

        <!-- Messages section goes here -->
        {% if messages %}
        <div class="messages container mx-auto px-4 mt-4">
            {% for message in messages %}
            <div class="message p-4 mb-2 rounded {% if message.tags == 'success' %}bg-green-100 text-green-800{% elif message.tags == 'error' %}bg-red-100 text-red-800{% elif message.tags == 'warning' %}bg-yellow-100 text-yellow-800{% elif message.tags == 'info' %}bg-blue-100 text-blue-800{% else %}bg-gray-100 text-gray-800{% endif %}">
                {{ message|safe }}
                <button class="float-right focus:outline-none hover:text-gray-500">&times;</button>
            </div>
            {% endfor %}
        </div>
        {% endif %}

    {% block content %}
    {% endblock %}

    <!-- Cookie Consent Banner  -->
     
      <aside
      id="cookie-banner"
      class="fixed bottom-0 left-0 right-0 bg-gray-900 text-white py-4 px-6 hidden z-50"
      role="dialog"
      aria-labelledby="cookie-title"
    >
      <div
        class="max-w-7xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-4"
      >
        <div class="text-sm">
          <h2 id="cookie-title" class="sr-only">Cookie Consent</h2>
          We use cookies to enhance your experience. By continuing to visit this
          site you agree to our use of cookies.
          <a
            href="{% url 'core:privacy_policy' %}"
            class="text-accent hover:text-text underline transition-colors"
            >Privacy Policy</a
          >
        </div>
        <div class="flex gap-4">
          <button
            id="accept-cookies"
            class="bg-purple-700 hover:bg-purple-800 text-white px-4 py-2 rounded-lg text-sm transition-colors"
            aria-label="Accept cookies"
          >
            Accept
          </button>
          <button
            id="decline-cookies"
            class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg text-sm transition-colors"
            aria-label="Decline cookies"
          >
            Decline
          </button>
        </div>
      </div>
    </aside>

    {% block onload_js %}
    <!-- JavaScript links -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="{% static 'js/pagination.js' %}"></script>
    <script src="{% static 'js/report.js' %}"></script>
    {% endblock %}

    <!-- Cookie Consent and Message Auto-close JavaScript -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Cookie consent functionality
        const cookieConsent = localStorage.getItem("cookieConsent");
        const banner = document.getElementById("cookie-banner");

        if (!cookieConsent && banner) {
            banner.classList.remove("hidden");
        }

        if (document.getElementById("accept-cookies")) {
            document.getElementById("accept-cookies").addEventListener("click", function () {
                localStorage.setItem("cookieConsent", "accepted");
                banner.classList.add("hidden");
            });
        }

        if (document.getElementById("decline-cookies")) {
            document.getElementById("decline-cookies").addEventListener("click", function () {
                localStorage.setItem("cookieConsent", "declined");
                banner.classList.add("hidden");
            });
        }
        
        // Auto-close messages functionality
        const messages = document.querySelectorAll('.messages .message');
        
        // Add click event handlers for manual close buttons
        document.querySelectorAll('.messages .message button').forEach(button => {
            button.addEventListener('click', function() {
                this.closest('.message').remove();
            });
        });
        
        // Auto-close messages after 3 seconds
        if (messages.length > 0) {
            setTimeout(function() {
                messages.forEach(message => {
                    message.classList.add('opacity-0');
                    // Remove from DOM after fade out animation completes
                    setTimeout(function() {
                        message.remove();
                    }, 300);
                });
            }, 3000);
        }
    });
</script>
</body>
</html>